<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Test Suite - webserv</title>
  <link rel="stylesheet" href="/css/style.css" />
</head>

<body class="test-page">
  <div class="container">
    <a href="/" class="back-link">‚Üê Home</a>
    <h1>Try it out</h1>
    <p class="subtitle">Have fun and enjoy the stay</p>

    <h2 style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
      <img src="/image/walking_bro.gif" alt="Walking Bro" style="width: 100px; height: auto;" />
      <span>Feature Tests</span>
      <img src="/image/walking_bro.gif" alt="Walking Bro" style="width: 100px; height: auto; transform: scaleX(-1);" />
    </h2>
    <div class="test-grid">
      <a href="/tests/limits/" class="test-card">
        <h3>ü§è Request Limits</h3>
        <p>Test request body size limits</p>
      </a>
      <a href="/tests/upload/" class="test-card">
        <h3>üì§ File Upload</h3>
        <p>Upload and delete files using PUT and DELETE</p>
      </a>
      <a href="/tests/custom-error/" class="test-card">
        <h3>‚ö†Ô∏è Custom Error Page</h3>
        <p>Trigger errors to view the custom error page</p>
      </a>
      <a href="/tests/timeout/" class="test-card">
        <h3>‚è±Ô∏è Timeout</h3>
        <p>Test CGI script timeout handling</p>
      </a>
    </div>

    <h2>Handler Tests</h2>
    <div class="test-grid">
      <a href="/tests/static/" class="test-card">
        <h3>üìÅ Static Files</h3>
        <p>Test static file serving, directory listing, and 404 errors</p>
      </a>
      <a href="/uploads/" class="test-card">
        <h3>üóÉÔ∏è Autoindex</h3>
        <p>Directory listing at the server root</p>
      </a>
      <a href="/tests/redirect/" class="test-card">
        <h3>üîÄ Redirects</h3>
        <p>Test HTTP redirects</p>
      </a>
      <a href="/tests/cgi/" class="test-card">
        <h3>‚öôÔ∏è CGI Scripts</h3>
        <p>Execute Python and Shell CGI scripts</p>
      </a>
    </div>
  </div>
  <footer class="footer">webserv by fmartusc, edforte, lrocca</footer>

  <script>
    function dropBread(side) {
      const img = document.createElement('img');
      img.src = '/image/bread.png';
      img.alt = 'Bread';
      img.style.position = 'fixed';
      img.style.top = '-800px';
      img.style.width = '400px';
      img.style.height = 'auto';
      img.style.zIndex = 2;
      img.style.opacity = '0.65';
      img.style.pointerEvents = 'none';
      img.style.transition = 'transform 0.2s';
      if (side === 'left') {
        img.style.left = '10px';
      } else {
        img.style.right = '10px';
      }
      document.body.appendChild(img);
      const speed = Math.random() * 2 + 1.5;
      let pos = -400;
      function fall() {
        pos += speed;
        img.style.top = pos + 'px';
        if (pos < window.innerHeight + 200) {
          requestAnimationFrame(fall);
        } else {
          img.remove();
        }
      }
      requestAnimationFrame(fall);
    }

    let breadLeftInterval = null;
    let breadRightInterval = null;

    function startBreadIntervals() {
      if (!breadLeftInterval) breadLeftInterval = setInterval(() => { dropBread('left'); }, 3000);
      if (!breadRightInterval) breadRightInterval = setInterval(() => { dropBread('right'); }, 3000);
    }
    function stopBreadIntervals() {
      if (breadLeftInterval) { clearInterval(breadLeftInterval); breadLeftInterval = null; }
      if (breadRightInterval) { clearInterval(breadRightInterval); breadRightInterval = null; }
    }

    document.addEventListener('visibilitychange', function () {
      if (document.visibilityState === 'visible') {
        startBreadIntervals();
      } else {
        stopBreadIntervals();
      }
    });

    if (document.visibilityState === 'visible') {
      startBreadIntervals();
    }
  </script>
</body>

</html>
